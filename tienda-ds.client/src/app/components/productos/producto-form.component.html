<div class="form-container">
  <h2>{{ isEditMode ? 'Editar Producto' : 'Nuevo Producto' }}</h2>

  <div *ngIf="error" class="error">{{ error }}</div>

  <form [formGroup]="productoForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="NombreProd">Nombre del Producto *</label>
      <input
        type="text"
        id="NombreProd"
        formControlName="NombreProd"
        class="form-control"
        [class.invalid]="productoForm.get('NombreProd')?.invalid && productoForm.get('NombreProd')?.touched"
      />
      <div class="error-message" *ngIf="productoForm.get('NombreProd')?.invalid && productoForm.get('NombreProd')?.touched">
        <span *ngIf="productoForm.get('NombreProd')?.errors?.['required']">El nombre es requerido</span>
        <span *ngIf="productoForm.get('NombreProd')?.errors?.['minlength']">Debe tener al menos 3 caracteres</span>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="PrecioVenta">Precio de Venta *</label>
        <input type="number" id="PrecioVenta" formControlName="PrecioVenta" class="form-control" step="0.01"
          [class.invalid]="productoForm.get('PrecioVenta')?.invalid && productoForm.get('PrecioVenta')?.touched" />
        <div class="error-message" *ngIf="productoForm.get('PrecioVenta')?.invalid && productoForm.get('PrecioVenta')?.touched">
          <span *ngIf="productoForm.get('PrecioVenta')?.errors?.['required']">El precio de venta es requerido</span>
          <span *ngIf="productoForm.get('PrecioVenta')?.errors?.['min']">Debe ser mayor o igual a 0</span>
        </div>
      </div>

      <div class="form-group">
        <label for="PrecioCompra">Precio de Compra *</label>
        <input type="number" id="PrecioCompra" formControlName="PrecioCompra" class="form-control" step="0.01"
          [class.invalid]="productoForm.get('PrecioCompra')?.invalid && productoForm.get('PrecioCompra')?.touched" />
        <div class="error-message" *ngIf="productoForm.get('PrecioCompra')?.invalid && productoForm.get('PrecioCompra')?.touched">
          <span *ngIf="productoForm.get('PrecioCompra')?.errors?.['required']">El precio de compra es requerido</span>
          <span *ngIf="productoForm.get('PrecioCompra')?.errors?.['min']">Debe ser mayor o igual a 0</span>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label for="Stock">Stock</label>
      <input type="number" id="Stock" formControlName="Stock" class="form-control" />
    </div>

    <div class="form-group">
      <label for="IdProveedor">Proveedor</label>
      <select id="IdProveedor" formControlName="IdProveedor" class="form-control">
        <option value="">Sin proveedor</option>
        <option *ngFor="let proveedor of proveedores" [value]="proveedor.IdProveedor">
          {{ proveedor.Empresa }}
        </option>
      </select>
      <small>Opcional</small>
    </div>

    <div class="form-actions">
      <button type="submit" class="btn btn-primary" [disabled]="loading">
        {{ loading ? 'Guardando...' : (isEditMode ? 'Actualizar' : 'Crear') }}
      </button>
      <button type="button" class="btn btn-secondary" (click)="onCancel()">
        Cancelar
      </button>
    </div>
  </form>
</div>
